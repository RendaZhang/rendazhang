<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

- [项目需求清单](#%E9%A1%B9%E7%9B%AE%E9%9C%80%E6%B1%82%E6%B8%85%E5%8D%95)
  - [简介](#%E7%AE%80%E4%BB%8B)
  - [🚀 核心功能体系](#-%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E4%BD%93%E7%B3%BB)
    - [智能交互系统](#%E6%99%BA%E8%83%BD%E4%BA%A4%E4%BA%92%E7%B3%BB%E7%BB%9F)
    - [全球化体验](#%E5%85%A8%E7%90%83%E5%8C%96%E4%BD%93%E9%AA%8C)
    - [视觉与体验](#%E8%A7%86%E8%A7%89%E4%B8%8E%E4%BD%93%E9%AA%8C)
    - [内容管理系统](#%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F)
    - [性能与基建](#%E6%80%A7%E8%83%BD%E4%B8%8E%E5%9F%BA%E5%BB%BA)
    - [开发运维体系](#%E5%BC%80%E5%8F%91%E8%BF%90%E7%BB%B4%E4%BD%93%E7%B3%BB)
    - [导航系统](#%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F)
  - [🔧 技术需求](#-%E6%8A%80%E6%9C%AF%E9%9C%80%E6%B1%82)
    - [已完成需求 ✅](#%E5%B7%B2%E5%AE%8C%E6%88%90%E9%9C%80%E6%B1%82-)
    - [待完成需求 ⏳](#%E5%BE%85%E5%AE%8C%E6%88%90%E9%9C%80%E6%B1%82-)
  - [关键技术说明 🔍](#%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF%E8%AF%B4%E6%98%8E-)
  - [🌱 未来计划](#-%E6%9C%AA%E6%9D%A5%E8%AE%A1%E5%88%92)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

# 项目需求清单

- **负责人**: 张人大（Renda Zhang）
- **最后更新**: July 30, 2025, 17:58 (UTC+8)
- **项目状态**: 稳定运行，持续开发中

---

## 简介

此仓库为网站的前端代码库，采用 **Astro** + **React** 架构，通过 **GitHub Actions** 实现自动化构建与部署，最终发布到 **Nginx** 服务器。网站核心功能包括：

- **中英文双语切换**：支持用户无缝切换中英文语言，提升多语言用户的访问体验。
- **内容展示**：用于展示个人简历、证书及技术文档，帮助访客全面了解相关信息。
- **AI 聊天功能**：集成 AI 聊天助手，提供智能交互与技术支持。

---

## 🚀 核心功能体系

### 智能交互系统
- **AI 对话引擎**：Markdown 渲染 + Mermaid 图表解析 + 对话历史本地存储
- **全局聊天浮窗**：全站触达式悬浮入口（深度聊天页面除外）
- **智能联系表单**：多语言验证体系 + 动态提交反馈

### 全球化体验
- **国际化解决方案**：所有页面完整多语言覆盖
- **多语言个人主页**：中英双语简历下载 + 专业技能矩阵
- **全球证书墙**：Credly 官方认证徽章 + 链上验证系统

### 视觉与体验
- **自适应主题引擎**：深色/浅色模式一键切换（状态持久化）
- **沉浸式音效系统**：场景化背景音乐控制
- **响应式布局框架**：移动优先的跨设备适配方案

### 内容管理系统
- **动态文档中心**：实时Markdown渲染引擎
- **社交网络矩阵**：GitHub/CSDN/Medium 等平台无缝集成
- **数字资产墙**：证书/成就可视化展区

### 性能与基建
- **智能资源加载**：图片懒加载 + 按需资源分发
- **SEO 优化引擎**：搜索引擎友好架构
- **配置管理中心**：统一 API 路径与应用常量管理

### 开发运维体系
- **自动化部署流水线**：GitHub Actions 秒级发布
- **智能开发工具链**：ESLint + Prettier + Astro 预提交检查
- **文档同步系统**：README 与目录结构自动更新

### 导航系统
- **全局导航中枢**：全站统一导航栏（主题/语言切换集成）

---

## 🔧 技术需求

### 已完成需求 ✅

- [x] **基本环境部署**
  - 通过 GitHub Actions 实现代码自动部署到生产服务器
  - 配置 pre-commit 钩子（ESLint、Prettier、Astro Check），保证了代码质量
  - 提交前自动运行 doctoc 更新文档目录结构，确保了文档自动化
- [x] **Pre Commit 功能**
  - Pre Commit 自动将根目录 `README.md` 同步到 `public/` 目录
  - Pre Commit 自动将根目录 `README.EN.md` 同步到 `public/` 目录
  - Pre Commit 自动更新 README 和 `docs/` 目录下的文档的 Doctoc 目录
  - 新增 `validate-assets` 脚本确保图片与音乐文件命名规范
  - Pre Commit 自动执行静态资源命名验证脚本
  - 完善 pre-commit 文档同步流程和使用说明
- [x] **页面元信息配置**
  - 为所有页面添加了标准的 meta 标签，确保页面在搜索引擎中能够被正确索引和展示
  - 通过统一的配置文件或组件，集中管理所有页面的 SEO 设置，便于后续维护和更新
  - 为特定地区或语言的页面添加了 hreflang 标签和地理定位 meta 信息，提升目标用户的搜索体验和页面排名
- [x] **页面风格统一**
  - 主题偏好存入 localStorage 保持用户设置
  - 确保所有页面的主题风格一致
  - 完成多语言支持框架（双内容渲染 + CSS 切换）
  - 实现所有页面的多语言动态切换
  - 实现 `docs.astro` 多语言支持（双 Markdown 渲染）
  - 确保语言切换后，所有文字内容使用对应的语言展示
- [x] **页面初级重构**
  - 创建 ChatWidget 组件（浮标按钮 + 面板显示逻辑）
  - 聊天小组件 (`ChatWidget.jsx`) 支持按需加载 CSS 资源，可以在组件挂载时通过 `loadStyle()` 动态向 `<head>` 插入 `<link>`
  - 在 `index.astro` 引入 ChatWidget 组件
  - 集中管理 API 路径、常量等配置项
  - 导航栏包含主页/登录/注册跳转功能
  - 实现从左到右布局：汉堡菜单 → 首页图标 → 主题/语言切换 → 头像图标
  - 主页改变：About 页面（原来的 `about.astro`）已经变为 Index 页面（`index.atro`）
- [x] **性能增强方案**
  - 所有图片资源懒加载
  - 异步加载优化：将脚本注入改为 `import()` 动态导入
  - 确保所有放置在 `src/assets` 目录下的资源都通过 import ?url 导入引用，这样 Astro 会自动为它们生成哈希指纹；或在构建脚本中引入处理。
  - 运行 `npm run build` 后，`dist/_astro` 目录会包含带有哈希后缀的文件，Astro/Vite 自动启用文件指纹机制，便于利用长效缓存


### 待完成需求 ⏳

- [ ] **LQIP 图片懒加载优化方案**
  - Low Quality Image Placeholder
  - 针对对需要使用高质量图片的页面
  - 采用「低质量图片占位 → 高质量图片懒加载替换」方案
- [ ] **实现登录和注册功能**
  - 使用轻量级方案做一个登录注册功能
- [ ] **组件拆分优化**
  - 将 Chat.jsx 拆分为：消息列表、输入区、加载状态等独立组件
- [ ] **组件化重构**
  - 创建复用组件（HeroSection, SkillsSection 等）
- [ ] **Head 组件封装**
  - 创建复用 `<Head>` 组件管理公共 meta 标签
- [ ] **聊天组件全局化**
  - 除 deepseek_chat 外，在所有页面展示 ChatWidget
- [ ] **状态管理升级**
  - 引入 Zustand 管理跨组件共享状态
- [ ] **TypeScript 迁移**
  - 逐步将 .jsx 转为 .tsx 并添加类型声明
- [ ] **测试体系建设**
  - 引入 React Testing Library + Playwright 测试框架
- [ ] **i18n 方案升级**
  - 评估引入专业 i18n 库管理多语言内容

---

## 关键技术说明 🔍

- **国际化实现细节**：
   - 采用双内容同步渲染技术
   - 通过 `html[lang]` 属性控制内容显隐
   - CSS 规则：
      ```css
      html[lang^='en'] .lang-zh {
        display: none;
      }
      html[lang^='zh'] .lang-en {
        display: none;
      }
      ```

- **多语言覆盖范围**：
   | 页面类型       | 实现状态 |
   |----------------|----------|
   | 主页           | ✅       |
   | 证书展示       | ✅       |
   | 聊天           | ✅       |
   | 登录/注册      | ✅       |
   | 技术文档       | ✅       |
   | 全局组件       | ✅       |

- **状态管理规划**：
   ```mermaid
   graph TD
     A[组件状态] --> B(useState)
     C[跨组件状态] --> D(useContext)
     E[应用级状态] --> F(Zustand)
   ```

- **TypeScript 迁移策略**：
   ```mermaid
   timeline
     阶段1 ： 新增组件使用 TSX
     阶段2 ： 核心组件迁移
     阶段3 ： 工具函数添加类型
     阶段4 ： 全量类型检查
   ```

- **多语言实现架构**：
   ```mermaid
   graph LR
     A[双内容渲染] --> B[CSS 选择器控制]
     B --> C{语言切换}
     C -->|即时更新| D[无刷新体验]
     C -->|SSR/CSR同步| E[无闪烁渲染]
   ```

- **聊天系统优化**：
   - Markdown 语法高亮 + 代码块渲染
   - Mermaid 图表动态解析引擎
   - 对话历史 LRU(最近最少使用) 缓存策略
   - 移动端手势支持（滑动关闭/缩放）

- **性能增强方案**：
   - 图片懒加载：`<img loading="lazy">`
   - 资源按需加载：`import()` 动态导入
   - 主题切换零延迟：CSS 变量驱动
   - LQIP：低质量图片占位，高质量图片懒加载替换
   - 构建产物指纹：`npm run build` 后 `dist/_astro` 中的文件会带有哈希后缀，可在 Nginx 中配置长效缓存

- **自动化工作流**：
   ```mermaid
   sequenceDiagram
     开发者->>GitHub: 代码提交
     GitHub->>服务器: 自动触发 Actions
     服务器->>生产环境: 安全部署
     生产环境-->>用户: 实时更新
   ```

---

## 🌱 未来计划

- 丰富项目展示模块，支持动态加载项目数据
- 提供离线访问能力（PWA）
- 持续完善 SEO / GEO 优化
- 文件指纹机制已启用，后续继续完善缓存策略
