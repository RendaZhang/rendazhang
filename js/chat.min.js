document.addEventListener("DOMContentLoaded", function() {
    const chatContainer = document.getElementById("chatContainer");
    const chatInput = document.getElementById("chatInput");
    const chatSendButton = document.getElementById("chatSendButton");

    chatSendButton.addEventListener("click", function() {
        let message = chatInput.value.trim();

        if (message) {
            appendMessage(message, "user");
            chatInput.value = "";

            fetch('/cloudchat/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ message: message })
            }).then(response => response.text()).then(text => {
                appendMessage(text, "ai");
            }).catch(error => {
                console.error("Error:", error);
            });
        }
    });

    function appendMessage(message, sender) {
        const messageDiv = document.createElement("div");
        messageDiv.textContent = message;
        messageDiv.classList.add(sender);
        chatContainer.appendChild(messageDiv);
        chatContainer.scrollTop = chatContainer.scrollHeight;
    }
});
