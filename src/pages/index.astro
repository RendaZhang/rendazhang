---
import IndexContent from '../components/IndexContent.jsx';
import BaseLayout from '../layouts/BaseLayout.astro';
import {
  SITE_BASE_URL,
  SITE_DOMAIN,
  SITE_DESCRIPTION_EN,
  SITE_DESCRIPTION_ZH,
  SITE_AUTHOR_EN,
  SCRIPT_PATHS,
  STYLE_PATHS,
  PAGE_TITLES,
  LOGO_ALT,
  HOME_PAGE_PATH,
  DEFAULT_SOCIAL_IMAGE,
  OG_IMAGE_DIMENSIONS,
  IMAGE_PATHS
} from '../config.js';
import { getCurrentLang } from '../utils/langUtils.js';

const langDefault = getCurrentLang();
const langKey = langDefault.startsWith('zh') ? 'zh' : 'en';
const title = langKey === 'zh' ? PAGE_TITLES.ABOUT_ZH : PAGE_TITLES.ABOUT_EN;
const description = langKey === 'zh' ? SITE_DESCRIPTION_ZH : SITE_DESCRIPTION_EN;
---

<BaseLayout
  lang={langDefault}
  title={title}
  description={description}
  canonical={`${SITE_BASE_URL}${HOME_PAGE_PATH}`}
  preloadStyles={[STYLE_PATHS.CHAT_WIDGET]}
  extraStyles={[STYLE_PATHS.INDEX, STYLE_PATHS.CHAT_WIDGET]}
  extraScripts={[SCRIPT_PATHS.LAZYLOAD, SCRIPT_PATHS.INDEX]}
  og={{
    title: PAGE_TITLES.INDEX_OG,
    description,
    url: `${SITE_BASE_URL}${HOME_PAGE_PATH}`,
    image: `${SITE_BASE_URL}${DEFAULT_SOCIAL_IMAGE}`,
    imageWidth: OG_IMAGE_DIMENSIONS.WIDTH,
    imageHeight: OG_IMAGE_DIMENSIONS.HEIGHT,
    imageAlt: langKey === 'zh' ? LOGO_ALT.ZH : LOGO_ALT.EN,
    secureImageUrl: `${SITE_BASE_URL}${DEFAULT_SOCIAL_IMAGE}`
  }}
  twitter={{
    title: PAGE_TITLES.INDEX_OG,
    description,
    image: `${SITE_BASE_URL}${DEFAULT_SOCIAL_IMAGE}`,
    imageAlt: langKey === 'zh' ? LOGO_ALT.ZH : LOGO_ALT.EN,
    domain: SITE_DOMAIN
  }}
  metaAuthor={SITE_AUTHOR_EN}
  metaLanguage="en, zh-CN"
>
  <IndexContent client:load />

  <Fragment slot="bodyEnd">
    <div id="wechatModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <div class="loader"></div>
        <img
          id="wechatQR"
          data-src={IMAGE_PATHS.WECHAT_QR}
          alt="WeChat Official Account QR code"
          style="display:none;"
        />
      </div>
    </div>
  </Fragment>
</BaseLayout>
